<!-- /*
  This nice dropzone based on Luis Moncaris's Tutorial title
  How to create a Drag and Drop file directive in angular2 with angular-cli
  URL: https://scotch.io/@minrock/how-to-create-a-drag-and-drop-file-directive-in-angular2-with-angular-cli-part-1
    https://scotch.io/@minrock/how-to-create-a-drag-and-drop-file-directive-in-angular2-with-angular-cli-part-2
*/ -->
<div class="ui centered grid pt-10">
  <div class="ten wide column">
    <form [formGroup]="uploadForm" class="ui form">
      <div class="inline field">
        <label>Select Gallery to Upload</label>
        <select formControlName="upldGallery" class="menu" required>
          <option *ngFor="let g of galleries" [value]="g.galleryId" class="item">{{g.gallery|titlecase}}</option>
        </select>
        <label>Select Year</label>
        <select formControlName="yearPicker" class="menu" required>
          <option class="item" *ngFor="let y of years" [value]="y">{{y}}</option>
        </select>
      </div>
      <div class="dropzone" appDnd (filesChangeEmitter)="onFileChange($event)"
        (filesInvalidEmitter)="onInvalidFileChange($event)" [allowed_extensions]="allowed_ext">
        <div class="text-wrapper">
          <div class="centered">Drop your file here!</div>
        </div>
      </div>
    </form>

    <div class="pt-10" *ngIf="invalidImageInfos.length !== 0 || validImageInfos.length !== 0">
      <div class="ui grid">
        <div class="row">
          <div class="three wide column">Image</div>
          <div class="five wide column">File Name</div>
          <div class="three wide column">Author</div>
          <div class="two wide column">Size(KB)</div>
          <div class="three wide column center aligned">Actions</div>
        </div>
      </div>
      <div class="ui grid" *ngIf="validImageInfos.length !== 0">
        <div class="row" *ngFor="let url of reviewUrl; let i=index">
          <div class="three wide column">
            <div class="ui tiny image">
              <img [src]="url">
            </div>
          </div>
          <div class="five wide column">
            <div class="description">{{validImageInfos[i].filename}}</div>
          </div>
          <div class="three wide column">{{validImageInfos[i].author}}</div>
          <div class="two wide column">
            <div class="description">{{validImageInfos[i].size/1024|number:'.2-2'}}</div>
          </div>
          <div class="three wide column right aligned">
            <button class=" mini ui negative basic button" (click)="removeFile(i)">Remove</button>
            <button class=" mini ui positive basic button" (click)="uploadFile(i)" [disabled]="!uploadForm.valid">Upload</button>
          </div>
        </div>
      </div>
      <div class="ui grid" *ngIf="invalidImageInfos.length > 0">
        <div class="row" *ngFor="let url of reviewInvalidUrl; let i=index">
          <div class="three wide column">
            <div class="ui small image" *ngIf="!url">
              <i class="large file icon"></i>
            </div>
            <div class="ui tiny image" *ngIf="url">
              <img [src]="url">
            </div>
          </div>
          <div class="five wide column">
            <div class="description">
              <div class="red text" *ngIf="!isValidFileName(invalidImageInfos[i].filename)">Invalid File Name Format: </div>
              <div>{{invalidImageInfos[i].filename}}</div>
            </div>
          </div>
          <div class="three wide column">{{invalidImageInfos[i].author}}</div>
          <div class="two wide column">
            <div class="description">{{invalidFileArray[i].size/1024|number:'.2-2'}}</div>
          </div>
          <div class="three wide column right aligned">
            <button class=" mini ui negative basic button" (click)="removeInvalidFile(i)">Remove</button>
          </div>
        </div>
      </div>
      <div class="ui grid">
        <div class="inline">
          <button class="large ui negative button" (click)="removeAllFiles()">Remove All</button>
          <button class="large ui positive button" (click)="uploadAllFiles()" [disabled]="!uploadForm.valid">Upload All</button>
        </div>
      </div>
    </div>
  </div>
</div>